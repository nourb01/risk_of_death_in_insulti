# risk_of_death_in_insulti

Веб-сервис для оценки риска возникновения инсульта. Проект объединяет классическое машинное обучение для точных прогнозов и современные языковые модели (GigaChat) для генерации персональных медицинских рекомендаций.

---

## Архитектура приложения

Приложение реализовано на базе фреймворка **Django** и следует модульной архитектуре:

1.  **Frontend:** Интерфейс на Django Templates.
2.  **Backend (Django):** Обработка данных анкеты, управление сессиями пользователей и маршрутизация.
3.  **ML Engine (Scikit-learn):** Скрипт `functions.py` загружает предобученную модель и выполняет бинарную классификацию.
4.  **AI Integration (GigaChat API):** Система динамических подсказок, которая активируется при высоком риске (>50%) и генерирует советы на основе конкретных показателей пациента.
5.  **Database (SQLite3):** Хранение анкетных данных для последующего анализа.



---

## Структура базы данных

Используется реляционная модель данных. Основная сущность — `StrokeData`:
* **Демографические показатели:** Пол, возраст, семейное положение.
* **Показатели здоровья:** Наличие гипертензии, болезней сердца, уровень глюкозы в крови, ИМТ (BMI).
* **Образ жизни:** Тип занятости, тип проживания (город/село), статус курения.

Данные передаются из ORM Django в ML-модель через предварительную обработку (One-Hot Encoding и Scaling).

---

## Инструкция по развертыванию

Для запуска проекта локально выполните следующие шаги:

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <ссылка_на_ваш_репозиторий>
    cd src/final_project/Web_service_06_ITS
    ```

2.  **Установите зависимости:**
    ```bash
    pip install django pandas scikit-learn joblib
    ```

3.  **Подготовьте базу данных:**
    ```bash
    python manage.py makemigrations
    python manage.py migrate
    ```

4.  **Разместите файлы моделей:**
    Убедитесь, что файлы `model.pkl`, `scaler.pkl` и `columns.pkl` находятся в корневой папке (рядом с `manage.py`).

5.  **Запустите сервер:**
    ```bash
    python manage.py runserver
    ```
    Сервис будет доступен по адресу: `http://127.0.0.1:8000/anketa/`

---

## Тестирование

В проекте реализована система автоматизированного тестирования, покрывающая ключевые узлы:
* **Валидация данных:** Проверка корректности ввода и защита от пустых/неверных данных.
* **Integrity:** Проверка сохранения данных в базу и корректности редиректов.
* **ML Logic:** Юнит-тесты для проверки форматов вывода вероятностей и рисков.
* **AI Logic:** Тестирование взаимодействия с генеративной моделью рекомендаций.

Запуск тестов:
```bash
python manage.py test
